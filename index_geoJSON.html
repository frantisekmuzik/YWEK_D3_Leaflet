<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="https://icons.iconarchive.com/icons/microsoft/fluentui-emoji-flat/512/World-Map-Flat-icon.png" />

    <title>Pokusná mapa v Leaflet</title>

    <link rel="stylesheet" href="leaflet.css" />
    <script src="leaflet.js"></script>
    <script src="leaflet_geoJSON.js"></script>


</head>
<body>
    <style>
        html, body {
            height: 100%;
            margin: 0;
        }

        .leaflet-container {
            height: 600px;
            width: 900px;
            max-width: 100%;
            max-height: 100%;
        }

        .leaflet-touch .leaflet-control-attribution {
            display: none;
        }
    </style>

    <style>
        #map {
            width: 800px;
            height: 500px;
        }

        .info {
            padding: 6px 8px;
            font: 14px/16px Arial, Helvetica, sans-serif;
            background: white;
            background: rgba(255,255,255,0.8);
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border-radius: 5px;
        }

            .info h4 {
                margin: 0 0 5px;
                color: #777;
            }

        .legend {
            text-align: left;
            line-height: 18px;
            color: #555;
        }

            .legend i {
                width: 18px;
                height: 18px;
                float: left;
                margin-right: 8px;
                opacity: 0.7;
            }
    </style>

    <div id="mapa" class="leaflet-container" style="margin: 30px 30px 30px 30px;"></div>

    <script>

        const map = L.map('mapa').setView([50.12, 14.4], 14);

        const tileLayer1 = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 20,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);

        const tileLayer2 = L.tileLayer('https://www.chartae-antiquae.cz/TMS/Military2/{z}/{x}/{y}');

    // BODÍKY, POLYGONY

 const marker = L.marker([50.1040, 14.3907])
   .addTo(map).bindPopup(`<strong>Ahoj.</strong><br />Já jsem pop-up.<br>Právě jsem v  NTK.`);


    var mujgeojson = {
    "type": "Feature",
    "properties": {
        "name": "Bodík",
        "amenity": "stadion",
        "popupContent": "Pop-up"
    },
    "geometry": {
        "type": "Point",
        "coordinates": [14.32, 50.1]
    }
};

var myLines = [{
    "type": "LineString",
    "coordinates": [[14.5,50], [14.6,50], [14.7,50]]
}, {
    "type": "LineString",
    "coordinates": [[14.6,50], [14.6,50.2], [14.6,50.5]]
}];

var styl1 = {
    "color": "#FF0000",
    "weight": 4,
    "opacity": 0.65
};


var geojsonMarkerOptions = {
    radius: 6,
    fillColor: "#ff7800",
    color: "#000",
    weight: 1,
    opacity: 1,
    fillOpacity: 0.8
};


const info = L.control();

info.onAdd = function (map) {
		this._div = L.DomUtil.create('div', 'info');
		this.update();
		return this._div;
	};


    info.update = function (props) {
		const contents = props ? `<b>${props.NAZEV}</b><br />${props.HUSTOTA} obyv. / km<sup>2</sup>` : 'Přejeďte nad ORP';
		this._div.innerHTML = `<h4>Hustota obyvatelstva</h4>${contents}`;

	};

info.addTo(map);

function getColor(d) {
		return d > 2000 ? '#4a1486' :
			d > 1000  ? '#6a51a3' :
			d > 500  ? '#807dba' :
			d > 250  ? '#9e9ac8' :
			d > 150  ? '#bcbddc' :
			d > 80   ? '#dadaeb' : '#f2f0f7';
	}

function kartogram(feature) {
		return {
			weight: 2,
			opacity: 1,
			color: '#121212',
			fillOpacity: 0.7,
			fillColor: getColor(feature.properties.HUSTOTA)
		};
	}


    function highlightFeature(e) {
		const layer = e.target;

		layer.setStyle({
			weight: 5,
			color: '#666',
			dashArray: '',
			fillOpacity: 0.7
		});

		layer.bringToFront();

		info.update(layer.feature.properties);
	}


    geojson = L.geoJSON(ORP, {
		style: kartogram,
        onEachFeature: onEachFeature
	}).addTo(map);

    function resetHighlight(e) {
		geojson.resetStyle(e.target);
		info.update();
	}

	function zoomToFeature(e) {
		map.fitBounds(e.target.getBounds());
	}

	function onEachFeature(feature, layer) {
		layer.on({
			mouseover: highlightFeature,
			mouseout: resetHighlight,
			click: zoomToFeature
		});
	}


	const legend = L.control({position: 'bottomright'});

	legend.onAdd = function (map) {

		const div = L.DomUtil.create('div', 'info legend');
		const grades = [0, 80, 150, 250, 500, 1000, 2000];
		const labels = [];
		let from, to;

		for (let i = 0; i < grades.length; i++) {
			from = grades[i];
			to = grades[i + 1];

			labels.push(`<i style="background:${getColor(from + 1)}"></i> ${from}${to ? `&ndash;${to}` : '+'}`);
		}

		div.innerHTML = labels.join('<br>');
		return div;
	};

	legend.addTo(map);

    </script>

    <div id="pod_mapou" style="margin: 30px 30px 30px 30px;">
        <h1>
            Pěkná mapa v Leaflet
        </h1>
        <p>
            Zde si můžete přepnout mapu:
            <br><br>

            <!-- TLAČÍTKO PRO PŘEPÍNÁNÍ VRSTEV MIMO MAPU -->

            <button id="prepnoutMapy">Přepnout mapy</button>
            <script>
        const prepTlacitko = document.getElementById('prepnoutMapy');
        prepTlacitko.addEventListener('click', function() {

        if (map.hasLayer(tileLayer1)) {
            map.removeLayer(tileLayer1);
            map.addLayer(tileLayer2);
        } else {
            map.removeLayer(tileLayer2);
            map.addLayer(tileLayer1);
        }
        });
            </script>
        </p>
    </div>



</body>
</html>